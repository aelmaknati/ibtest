module.exports={friendlyName:"View new password",description:'Display "New password" page.',inputs:{token:{description:"The password reset token from the email.",example:"4-32fad81jdaf$329"}},exits:{success:{viewTemplatePath:"pages/entrance/new-password"},invalidOrExpiredToken:{responseType:"expired",description:"The provided token is expired, invalid, or has already been used."}},fn:async function({token:token}){if(!token)throw sails.log.warn("Attempting to view new password (recovery) page, but no reset password token included in request!  Displaying error page..."),"invalidOrExpiredToken";var userRecord=await User.findOne({passwordResetToken:token});if(!userRecord||userRecord.passwordResetTokenExpiresAt<=Date.now())throw"invalidOrExpiredToken";return{token:token}}};